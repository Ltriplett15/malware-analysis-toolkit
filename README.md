# Malware Analysis Toolkit

## Overview

The Malware Analysis Toolkit is designed to facilitate the analysis of potentially malicious binaries in a controlled environment (sandbox). This toolkit includes static and dynamic analysis capabilities, allowing researchers and security professionals to investigate malware behavior safely.

## Contents

- **sandbox.py**: The main script for executing malware in a sandbox environment.
- **isolation_config.json**: Configuration file for sandbox settings.
- **sample_malware.exe**: A sample executable for testing the toolkit (replace with actual malware for analysis).
- **analysis_helpers.py**: Helper functions for analyzing system components, such as the registry and file access.
- **dynamic_analysis.py**: Contains functions for performing dynamic analysis of malware during execution.
- **static_analysis.py**: Contains functions for performing static analysis on malware binaries.
- **yara_rules.yar**: YARA rules for identifying and classifying malware.

## Prerequisites

Before running the toolkit, ensure you have the following installed:

- Python 3.6 or higher
- Required Python libraries:
  - `pyinotify` (for file monitoring on Linux/Unix)
  - `scapy` (for network monitoring)
  - Other dependencies as needed for static and dynamic analysis.

You can install the necessary packages using pip:

```bash
pip install pyinotify scapy
```

## Setup

1. **Clone the repository**:

   ```bash
   git clone <repository_url>
   cd malware-analysis-toolkit
   ```

2. **Configure the sandbox settings**:
   - Open `isolation_config.json` and customize the sandbox directory and timeout settings as needed:

   ```json
   {
       "sandbox_directory": "path/to/sandbox",
       "timeout": 60
   }
   ```

3. **Prepare your analysis environment**:
   - Ensure your analysis machine is secure and isolated, ideally using a virtual machine or dedicated analysis box.

## Usage

### Running the Toolkit

To execute the malware analysis, run the `sandbox.py` script:

```bash
python sandbox.py
```

You will be prompted to enter the path to the malware binary (e.g., `E:/COLLEGE WORK/project 2025/p/sample_malware.exe`).

### Analysis Workflow

1. **Sandbox Creation**: The toolkit will create an isolated directory based on the configuration.
2. **Malware Execution**: The specified malware binary will be copied and executed within the sandbox.
3. **Static Analysis**: The toolkit will perform static analysis on the binary, logging findings.
4. **Dynamic Analysis**: The toolkit will attempt to monitor the malware's behavior during execution, including file and network activities.
5. **Registry Analysis** (Windows): The toolkit will analyze the Windows registry for potentially malicious entries.
6. **Cleanup**: The sandbox will be cleaned up after the analysis completes.

### Analysis Helpers

The `analysis_helpers.py` module contains functions for:

- **Registry Analysis**: Analyzes the Windows registry for autorun entries.
- **File Access Monitoring**: Monitors file creation, deletion, and modification events on Linux/Unix systems.

### Static Analysis

The `static_analysis.py` module includes functions for analyzing the malware binary without executing it, utilizing methods such as:

- File header analysis
- String extraction
- YARA rule matching using the `yara_rules.yar` file.

### Dynamic Analysis

The `dynamic_analysis.py` module implements real-time analysis of the malwareâ€™s behavior during execution. It includes features such as:

- Network monitoring (be mindful of permissions)
- Process monitoring

## Example YARA Rules

The `yara_rules.yar` file can be modified to include custom rules for identifying specific malware patterns. Use the YARA tool to compile and test your rules.

## Error Handling

If you encounter any errors, consider the following common issues:

- **Permission Denied**: Ensure the script has appropriate permissions to access files and network resources.
- **Network Monitoring Errors**: Check your firewall settings and ensure the script is allowed to access the network.
- **Missing Modules**: Make sure all required Python libraries are installed.

## Contributing

Feel free to fork the repository and submit pull requests for enhancements or bug fixes. 

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
